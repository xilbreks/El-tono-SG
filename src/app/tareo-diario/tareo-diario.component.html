<h4 style="text-align: center;">
    Tareo Diario (RDT)
</h4>
<div>
    <label for="fecha">Fecha: </label>
    <input type="date" id="fecha" [formControl]="fcFecha" (change)="obtenerTareos()">
</div>
<div>
    <table class="excel-style-table">
        <thead>
            <tr>
                <th>
                    NÂ°
                </th>
                <th>
                    Nombre
                </th>
                <th>
                    Fecha
                </th>
                <th>
                    Hora entrada
                </th>
                <th>
                    Hora salida
                </th>
                <th style="min-width: 400px;">
                    Observaciones
                </th>
                <th>
                    Acciones
                </th>
            </tr>
        </thead>
        <tbody *ngIf="!cargando">
            <tr *ngFor="let tareo of tareos; let i = index">
                <td>
                    {{i+1}}
                </td>
                <td>
                    {{tareo.nombreUsuario}}
                </td>
                <td>
                    {{tareo.fecha}}
                </td>
                <td>
                    <button class="btn btn-sm" (click)="abrirModalEntrada(tareo.idTareo, modalEntrada)">
                        {{tareo.entradaHora}}:{{tareo.entradaMinuto}}
                    </button>
                </td>
                <td>
                    <button class="btn btn-sm" (click)="abrirModalSalida(tareo.idTareo, modalSalida)">
                        {{tareo.salidaHora}}:{{tareo.salidaMinuto}}
                    </button>
                </td>
                <td (dblclick)="abrirModalObservacion(tareo.idTareo, tareo.observaciones, modalObservacion)">
                    {{tareo.observaciones}}
                </td>
                <td>
                    <a class="btn btn-outline-success btn-sm" [routerLink]="'/rdt/' + tareo.idTareo">
                        Ver
                    </a>
                </td>
            </tr>
        </tbody>

        <tbody *ngIf="cargando">
            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
            cargando...
        </tbody>
    </table>
    <div>
        <button (click)="descargarExcel()">
            Descargar Excel
        </button>
    </div>
</div>

<!-----------------------------------------------
  -------------- HORA ENTRADA MODAL -------------
  ----------------------------------------------->
<ng-template #modalEntrada let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Hora de Entrada</h4>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
            (click)="modal.dismiss('Cross click')"></button>
    </div>
    <div class="modal-body">
        <p>
            RDT: {{frmEntrada.value.idTareo}}
        </p>
        <form [formGroup]="frmEntrada" autocomplete="off">
            <div class="row mb-3">
                <div class="col">
                    <label class="form-label">Hora</label>
                    <select class="form-select" formControlName="hora">
                        <option value="--">--</option>
                        <option value="07">07h</option>
                        <option value="08">08h</option>
                        <option value="09">09h</option>
                        <option value="10">10h</option>
                        <option value="11">11h</option>
                        <option value="12">12h</option>
                        <option value="13">13h</option>
                        <option value="14">14h</option>
                        <option value="15">15h</option>
                        <option value="16">16h</option>
                        <option value="17">17h</option>
                        <option value="18">18h</option>
                        <option value="19">19h</option>
                        <option value="20">20h</option>
                        <option value="21">21h</option>
                    </select>
                </div>
                <div class="col">
                    <label class="form-label">Minuto</label>
                    <select class="form-select" formControlName="minuto">
                        <option value="--">--</option>
                        <option value="00">00m</option>
                        <option value="01">01m</option>
                        <option value="02">02m</option>
                        <option value="03">03m</option>
                        <option value="04">04m</option>
                        <option value="05">05m</option>
                        <option value="06">06m</option>
                        <option value="07">07m</option>
                        <option value="08">08m</option>
                        <option value="09">09m</option>
                        <option value="10">10m</option>
                        <option value="11">11m</option>
                        <option value="12">12m</option>
                        <option value="13">13m</option>
                        <option value="14">14m</option>
                        <option value="15">15m</option>
                        <option value="16">16m</option>
                        <option value="17">17m</option>
                        <option value="18">18m</option>
                        <option value="19">19m</option>
                        <option value="20">20m</option>
                        <option value="21">21m</option>
                        <option value="22">22m</option>
                        <option value="23">23m</option>
                        <option value="24">24m</option>
                        <option value="25">25m</option>
                        <option value="26">26m</option>
                        <option value="27">27m</option>
                        <option value="28">28m</option>
                        <option value="29">29m</option>
                        <option value="30">30m</option>
                        <option value="31">31m</option>
                        <option value="32">32m</option>
                        <option value="33">33m</option>
                        <option value="34">34m</option>
                        <option value="35">35m</option>
                        <option value="36">36m</option>
                        <option value="37">37m</option>
                        <option value="38">38m</option>
                        <option value="39">39m</option>
                        <option value="40">40m</option>
                        <option value="41">41m</option>
                        <option value="42">42m</option>
                        <option value="43">43m</option>
                        <option value="44">44m</option>
                        <option value="45">45m</option>
                        <option value="46">46m</option>
                        <option value="47">47m</option>
                        <option value="48">48m</option>
                        <option value="49">49m</option>
                        <option value="50">50m</option>
                        <option value="51">51m</option>
                        <option value="52">52m</option>
                        <option value="53">53m</option>
                        <option value="54">54m</option>
                        <option value="55">55m</option>
                        <option value="56">56m</option>
                        <option value="57">57m</option>
                        <option value="58">58m</option>
                        <option value="59">59m</option>
                    </select>
                </div>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-primary" (click)="guardarEntrada()" [disabled]="!frmEntrada.valid"
            *ngIf="!guardando">
            Marcar Entrada
        </button>
        <button *ngIf="guardando" class="btn btn-primary">
            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
            Marcando...
        </button>
    </div>
</ng-template>

<!---------------------------------------------
-------------- HORA SALIDA MODAL --------------
----------------------------------------------->
<ng-template #modalSalida let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Hora de Salida</h4>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
            (click)="modal.dismiss('Cross click')"></button>
    </div>
    <div class="modal-body">
        <p>
            RDT: {{frmSalida.value.idTareo}}
        </p>
        <form [formGroup]="frmSalida" autocomplete="off">
            <div class="row mb-3">
                <div class="col">
                    <label class="form-label">Hora</label>
                    <select class="form-select" formControlName="hora">
                        <option value="--">--</option>
                        <option value="07">07h</option>
                        <option value="08">08h</option>
                        <option value="09">09h</option>
                        <option value="10">10h</option>
                        <option value="11">11h</option>
                        <option value="12">12h</option>
                        <option value="13">13h</option>
                        <option value="14">14h</option>
                        <option value="15">15h</option>
                        <option value="16">16h</option>
                        <option value="17">17h</option>
                        <option value="18">18h</option>
                        <option value="19">19h</option>
                        <option value="20">20h</option>
                        <option value="21">21h</option>
                    </select>
                </div>
                <div class="col">
                    <label class="form-label">Minuto</label>
                    <select class="form-select" formControlName="minuto">
                        <option value="--">--</option>
                        <option value="00">00m</option>
                        <option value="01">01m</option>
                        <option value="02">02m</option>
                        <option value="03">03m</option>
                        <option value="04">04m</option>
                        <option value="05">05m</option>
                        <option value="06">06m</option>
                        <option value="07">07m</option>
                        <option value="08">08m</option>
                        <option value="09">09m</option>
                        <option value="10">10m</option>
                        <option value="11">11m</option>
                        <option value="12">12m</option>
                        <option value="13">13m</option>
                        <option value="14">14m</option>
                        <option value="15">15m</option>
                        <option value="16">16m</option>
                        <option value="17">17m</option>
                        <option value="18">18m</option>
                        <option value="19">19m</option>
                        <option value="20">20m</option>
                        <option value="21">21m</option>
                        <option value="22">22m</option>
                        <option value="23">23m</option>
                        <option value="24">24m</option>
                        <option value="25">25m</option>
                        <option value="26">26m</option>
                        <option value="27">27m</option>
                        <option value="28">28m</option>
                        <option value="29">29m</option>
                        <option value="30">30m</option>
                        <option value="31">31m</option>
                        <option value="32">32m</option>
                        <option value="33">33m</option>
                        <option value="34">34m</option>
                        <option value="35">35m</option>
                        <option value="36">36m</option>
                        <option value="37">37m</option>
                        <option value="38">38m</option>
                        <option value="39">39m</option>
                        <option value="40">40m</option>
                        <option value="41">41m</option>
                        <option value="42">42m</option>
                        <option value="43">43m</option>
                        <option value="44">44m</option>
                        <option value="45">45m</option>
                        <option value="46">46m</option>
                        <option value="47">47m</option>
                        <option value="48">48m</option>
                        <option value="49">49m</option>
                        <option value="50">50m</option>
                        <option value="51">51m</option>
                        <option value="52">52m</option>
                        <option value="53">53m</option>
                        <option value="54">54m</option>
                        <option value="55">55m</option>
                        <option value="56">56m</option>
                        <option value="57">57m</option>
                        <option value="58">58m</option>
                        <option value="59">59m</option>
                    </select>
                </div>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-primary" (click)="guardarSalida()" [disabled]="!frmSalida.valid"
            *ngIf="!guardando">
            Marcar Salida
        </button>
        <button *ngIf="guardando" class="btn btn-primary">
            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
            Marcando...
        </button>
    </div>
</ng-template>

<!---------------------------------------------
-------------- OBSERVACION MODAL --------------
----------------------------------------------->
<ng-template #modalObservacion let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Observaciones</h4>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
            (click)="modal.dismiss('Cross click')"></button>
    </div>
    <div class="modal-body">
        <p>
            RDT: {{frmObserv.value.idTareo}}
        </p>
        <form [formGroup]="frmObserv" autocomplete="off">
            <div class="row mb-3">
                <div class="col">
                    <textarea formControlName="observaciones" class="form-control"></textarea>
                </div>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-primary" (click)="guardarObservacion()" [disabled]="!frmObserv.valid"
            *ngIf="!guardando">
            Guardar
        </button>
        <button *ngIf="guardando" class="btn btn-primary">
            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
            Guardando...
        </button>
    </div>
</ng-template>